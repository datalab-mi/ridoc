certResolvers:
  le:
    email: datalab@interieur.gouv.fr
    httpChallenge:
      entryPoint: "web"
    storage: /data/acme.json
    #caServer: https://acme-staging-v02.api.letsencrypt.org/directory
persistence:
  enabled: true
  name: traefik-internal
  accessMode: ReadWriteOnce
  size: 1Gi
  path: /data


service:
  enabled: false

providers:
  kubernetesIngress:
    ingressClass: traefik-internal
    publishedService:
      enabled: true

ingressClass:
  enabled: true
  isDefaultClass: true

ports:
  web:
    redirectTo: websecure
    hostPort: 80 
  websecure:
    tls:
      certResolver: le
    hostPort: 443

deployment:
  # Can be either Deployment or DaemonSet
  kind: DaemonSet
  initContainers:
    - name: volume-permissions
      image: busybox:latest
      securityContext:
        runAsNonRoot: false
        runAsGroup: 0
        runAsUser: 0
      command: ["sh", "-c", "sleep 30 ;chown -R 65532:65532 /data; chmod -Rv 600 /data/*"]
      volumeMounts:
      - mountPath: /data
        name: traefik-internal


updateStrategy:
  type: RollingUpdate
  rollingUpdate:
    maxUnavailable: 1
    maxSurge: 0

logs:
  general:
    # Alternative logging levels are DEBUG, PANIC, FATAL, ERROR, WARN, and INFO.
    level: INFO
  access:
    # To enable access logs
    enabled: true
    ## By default, logs are written using the Common Log Format (CLF) on stdout.
    ## To write logs in JSON, use json in the format option.
    ## If the given format is unsupported, the default (CLF) is used instead.
    # format: json
    filePath: "/tmp/logs/access.log"